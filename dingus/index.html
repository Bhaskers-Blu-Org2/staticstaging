<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="x-ua-compatible" content="ie=edge">

    <title>atw dingus</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.0.0-alpha/css/bootstrap.css">
    <style>
textarea {
    width: 100%;
    height: 30ex;
    font-family: Menlo, Monaco, Consolas, "Courier New", monospace;
}
#error, #result, #tree {
    display: none;
}
#clear {
    float: left;
    margin-right: 1em;
}
#tools {
    height: 2em;
}
#help {
    clear: both;
    margin-top: 1em;
}
#tree {
    max-height: 30ex;
    overflow: scroll;
}

.example:hover {
    background: rgba(0, 0, 0, 0.2);
}
#help p {
    margin-bottom: 0;
    color: #666;
}
#help pre {
    font-weight: bold;
}
    </style>
</head>
<body>
<div class="container">

<h1>atw dingus</h1>

<div class="row">
    <div class="col-sm-6">
        <textarea id="code"></textarea>
        <div id="tools">
            <button type="button" class="btn btn-secondary btn-sm" id="clear">
                clear
            </button>
            <p id="type"></p>
        </div>
    </div>

    <div class="col-sm-6">
        <div id="error" class="alert alert-danger"></div>
        <pre id="result"></pre>
        <pre id="tree"></pre>
    </div>
</div>

<div class="row" id="help">
    <div class="col-sm-12">
        <p>You can use arithmetic and variables:</p>
        <pre class="example"><code>let x = 7;
x * 3</code></pre>

        <p>And define functions:</p>
        <pre class="example"><code>let double = fun x:Int -&gt; x * 2;
double 21</code></pre>

        <p>Use angle brackets to defer code:</p>
        <pre class="example"><code>&lt; 45 - 3 &gt;</code></pre>

        <p>And bang to execute it:</p>
        <pre class="example"><code>!&lt; 45 - 3 &gt;</code></pre>

        <p>Use square brackets to escape and splice code:</p>
        <pre class="example"><code>let x = &lt;5&gt;;
!&lt; 37 + [x] &gt;</code></pre>

        <p>The type checker will catch you if you mix up your stages:</p>
        <pre class="example"><code>let x = &lt;5&gt;;
37 + x</code></pre>

        <p>There's also another kind of escape that <em>persists</em>
        outer-stage values:</p>
        <pre class="example"><code>let x = 5;
!&lt; 37 + %[x] &gt;</code></pre>

        <p>In line with other staged languages, you can also get
        cross-stage persistence transparently by just referring to
        variables from a different stage. This works by desugaring
        cross-stage references to persist escapes:</p>
        <pre class="example"><code>let x = 5;
!&lt;
  let y = 10;
  !&lt; x + y &gt;
&gt;</code></pre>

        <p>Click on an example above to run it.</p>
    </div>
</div>

</div>
<script type="text/javascript" src="parser.js"></script>
<script type="text/javascript" src="atw.js"></script>
</body>
</html>
